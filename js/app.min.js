!function(e){function t(){console.log("shooting bananas");for(var t=.8,n=Math.ceil(4*Math.random()+1),s=[0,-20],a=e(".bananas"),r=0;n>r;r++){var o=e('<div class="shooting-banana" />'),l=10*(.5-Math.random()),c=20*-Math.random();console.log("initial x velocity:",l+", initial y velocity:",c),a.append(o),i(o,s,l,c,t)}}function i(e,t,n,s,a){var r=t[0]+n,o=t[1]+s,l="matrix(1, 0, 0, 1, "+r+", "+o+")";s+=a,e[0].style.webkitTransform=l,e[0].style.MozTransform=l,e[0].style.msTransform=l,e[0].style.OTransform=l,e[0].style.transform=l,20>o?requestAnimationFrame(function(){i(e,[r,o],n,s,a)}):e.remove()}e(".input-wrapper").on("focus","input, textarea",function(){e(this).parent(".input-wrapper").addClass("focused")}).on("blur","input, textarea",function(){e(this).parent(".input-wrapper").removeClass("focused")}),e(".request-quote-form").length>0&&(e(".request-quote-form").validationEngine("attach",{showArrow:!1,binded:!1,promptPosition:"bottomLeft",custom_error_messages:{required:{message:"Oops, looks like you forgot to add this field"},"#url":{"custom[url]":{message:"That doesn't look like the URLs we're used to."}}}}),e(".request-quote-form").on("blur",".form-part1 input",function(){var t=e(this),i=e(".request-quote-form").find(".monkee-step"),n=e(".request-quote-form").find(".monkee"),s=!t.validationEngine("validate");s?t.parent().is(":last-child")&&t.parents(".form-step").addClass("complete"):t.parents(".form-step").removeClass("complete");var a=i.filter(".complete").length;if(a>0){var r=1-a/i.length;n.children(".dark-monkee").css("opacity",r),console.log("opacity should be",r)}a===i.length?n.addClass("speak"):n.removeClass("speak")}));var n=function(t){this.$el=e(t),this.$screenContainer=this.$el.find(".screens"),this.$screens=this.$screenContainer.children(".screen"),this.$thumbs=this.$el.find(".thumbs"),this.ratios={desktop:.727,tablet:1.328,phone:2.08},this.margin=160,this.width=this.$screenContainer.width(),this.thumbRatio=.2,this.activeSlide="desktop",this.siteName=this.$el.data("site")};if(n.prototype._getX=function(t,i,n){var s=(this.width-e(i).width()*n)/2;return"left"==t?-s:s},n.prototype._moveSlide=function(e,t,i){var n=i?i:this.thumbRatio,s="active"==t?1:n,a="active"==t?0:this._getX(t,e,n);console.log("moving slide",e,"to position",t),TweenLite.to(e,.5,{scale:s,x:a})},n.prototype.transitionSlides=function(e){this.$screenContainer.hasClass("initial")&&this.$screenContainer.removeClass("initial");for(var t in this.$screens){var i,n=this.$screens[t],s=n.hasClass("active")?"active":n.hasClass("right")?"right":"left";i="active"==s&&"right"==e||"right"==s&&"left"==e?"left":"left"==s&&"right"==e||"active"==s&&"left"==e?"right":"active","active"==s||"active"==i?n.css("z-index",2):n.css("z-index",1),this._moveSlide(n,i),n.removeClass(s).addClass(i)}},n.prototype.updateScreen=function(e){for(var t in this.$screens){var i=this.$screens[t].children(".screen-inner"),n="/assets/port-"+this.siteName+"-"+t+"-"+e+".png",s=document.createElement("img");s.src=n,i.html(s)}},n.prototype.init=function(){var t=this.width-2*this.margin,i=this.$screenContainer.height(),n=this,s={};this.$screens.each(function(){var a=e(this),r=a.data("device"),o=n.ratios[r]>1?i:t*n.ratios[r],l=n.ratios[r]<1?t:i/n.ratios[r];a.css({height:o+"px",width:l+"px",left:t/2-l/2+n.margin+"px",top:i/2-o/2+"px"}),s[r]=a}),this.$screens=s,n._moveSlide(this.$screens.phone,"left",.6),n._moveSlide(this.$screens.tablet,"right",.6),e(".slider-nav").on("click","a",function(t){t.preventDefault(),n.transitionSlides(e(this).hasClass("port-left")?"left":"right")}),this.$thumbs.on("click",".thumbnail",function(t){t.preventDefault(),n.$thumbs.find(".thumbnail").removeClass("active"),e(this).addClass("active");var i=e(this).data("screen");n.updateScreen(i)})},e(".port-slider").length>0){var s=new n(".port-slider");s.init()}var a=function(t){this.$el=e(t),this.$circles=this.$el.find(".circle"),this.$expander=this.$el.find(".circle-expander"),this.$cur_circle=null};a.prototype._placeBG=function(){var t=this.$el.offset(),i=this.$el.width(),n=this.$el.height();this.$circles.each(function(){var s=e(this),a=s.offset(),r=s.children(".bg");r.css({top:t.top-a.top+"px",left:t.left-a.left+"px",width:i+"px",height:n+"px"})})},a.prototype._animateInTitle=function(e){var t=this,i=this.$expander.children(".title-overlay"),n=this.$cur_circle.data("name"),s=this.$expander.children(".expander-nav").children("a").not("."+n);TweenLite.set(s.last(),{x:160,right:0,left:"auto",delay:e}),TweenLite.set(s.first(),{x:-160,left:0,right:"auto",delay:e,onComplete:function(){i.html(t.$cur_circle.siblings(".tagline").html())}}),TweenLite.to(i,.5,{y:40,delay:e,ease:Back.easeOut}),TweenLite.to(s,.15,{x:0,delay:e+.5})},a.prototype._animateOutTitle=function(){var e=this.$expander.children(".title-overlay"),t=this.$cur_circle.data("name"),i=this.$expander.children(".expander-nav").children("a").not("."+t);TweenLite.to(e,.5,{y:e.outerHeight()}),TweenLite.to(i.first(),.15,{x:-160}),TweenLite.to(i.last(),.15,{x:160})},a.prototype._animateIn=function(t){var i=e(t),n=i.siblings(".border"),s=i.children(".bg").data("bg");this.$cur_circle=i,this.$expander.css("z-index",4),this.$expander.children(".bg").css("background-image","url("+s+")"),i.parent("li").addClass("active"),TweenLite.to(n,.3,{scale:7}),TweenLite.to(this.$expander,.5,{opacity:1,delay:.5,onComplete:function(){TweenLite.set(n,{scale:1})}}),this._animateInTitle(1)},a.prototype._animateOut=function(){var e=this;this.$el.find("li").removeClass("active"),this._animateOutTitle(),TweenLite.to(this.$expander,.5,{opacity:0,delay:.5,onComplete:function(){e.$expander.css({"z-index":-1})}})},a.prototype._animateSwitch=function(t){this._animateOutTitle(),this.$cur_circle=e(t);var i=this.$cur_circle.children(".bg").data("bg"),n=this.$expander.children(".bg");this.$el.find("li").removeClass("active"),this.$cur_circle.parent("li").addClass("active"),TweenLite.to(n,.3,{opacity:0,delay:.5,onComplete:function(){n.css("background-image","url("+i+")"),TweenLite.to(n,.3,{opacity:1})}}),this._animateInTitle(1)},a.prototype.init=function(){var t=this;this._placeBG(),this.$el.on("click",".circle",function(){t._animateIn(this)}),this.$el.find(".close-btn").on("click",function(e){e.preventDefault(),t._animateOut()}),this.$expander.children(".expander-nav").on("click","a",function(i){i.preventDefault();var n=e(this).attr("class"),s=t.$el.find("ul ."+n);console.log("new class is",n,"new circle is",s[0]),t._animateSwitch(s)})};var r=new a(".hero-circles");r.init(),e(".troop-list").on("click",".trigger",function(t){t.preventDefault();var i=e(this),n=i.parent(),s=i.parents(".troop-list"),a=i.siblings(".profile-content");if(n.hasClass("active"))return n.removeClass("active"),void s.children("li").removeClass("inactive");s.children("li").not(n).removeClass("active").addClass("inactive"),n.removeClass("inactive").addClass("active");var r=n.position().top+n.outerHeight();a.css("top",r+"px")}),e(".bananas").on("mouseenter",t)}(jQuery);